---
phase: 05-ui-refactoring
plan: 01
type: execute
domain: frontend
---

<objective>
Extract ChannelCard and ChannelCarousel components from monolithic App.tsx.

Purpose: Begin decomposing the 452-line App.tsx by extracting the channel carousel subsystem (card + carousel) as self-contained components. This creates a `src/components/` directory structure and establishes the pattern for remaining extractions.

Output: Two new components (ChannelCard.tsx, ChannelCarousel.tsx) that encapsulate carousel rendering and drag behavior, with App.tsx reduced by ~80 lines.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/CONVENTIONS.md
@.planning/codebase/STRUCTURE.md

**Source files to refactor:**
@src/App.tsx
@src/App.css

**Established patterns (from CONVENTIONS.md):**
- PascalCase for React components
- camelCase for functions and variables
- `handle{Action}` prefix for event handlers
- `{noun}Ref` suffix for refs
- useCallback for memoized handlers
- Default export for components
- No path aliases (relative imports only)

**Where to add components (from STRUCTURE.md):**
- New components: `src/components/{ComponentName}.tsx`
- Styles: Keep in App.css initially (extraction optional later)

**Constraint:** This is a REFACTOR - no new features, no behavior changes. All existing functionality must work identically after extraction.
</context>

<tasks>
<task type="auto">
  <name>Task 1: Extract ChannelCard component</name>
  <files>
    src/components/ChannelCard.tsx (create)
    src/App.tsx (modify)
  </files>
  <action>
Create `src/components/` directory if it doesn't exist.

Create `src/components/ChannelCard.tsx` with:
- Props interface: `{ channel: Channel; index: number; isSelected: boolean; onSelect: (index: number) => void }`
- Import Channel type from App.tsx (will need to export it)
- Render the carousel-item div with img and title span
- Handle onClick to call onSelect(index)

In App.tsx:
- Export the Channel interface (add `export` keyword)
- Import ChannelCard from './components/ChannelCard'
- Replace the inline carousel-item JSX (lines 344-353) with `<ChannelCard ... />`

CSS stays in App.css - no style changes needed.

Do NOT change any class names, do NOT change any styling, do NOT add new features.
  </action>
  <verify>
    - `npm run build` succeeds without errors
    - `npm run lint` passes
    - File exists: src/components/ChannelCard.tsx
    - App.tsx imports and uses ChannelCard
  </verify>
  <done>
    - ChannelCard.tsx exists with proper TypeScript types
    - Channel interface is exported from App.tsx
    - Carousel renders identically (visual inspection via build)
    - No TypeScript errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Extract ChannelCarousel component</name>
  <files>
    src/components/ChannelCarousel.tsx (create)
    src/App.tsx (modify)
  </files>
  <action>
Create `src/components/ChannelCarousel.tsx` with:
- Props interface: `{ channels: Channel[]; selectedIndex: number; onSelectChannel: (index: number) => void; visible: boolean }`
- Move carouselRef and all drag handler state/functions into this component:
  - carouselRef (useRef)
  - isDragging (useRef)
  - startX (useRef)
  - scrollLeft (useRef)
  - handleMouseDown, handleMouseMove, handleMouseUp, handleMouseLeave
- Move the useEffect that scrolls carousel to selected item (lines 223-232)
- Import and use ChannelCard for rendering items
- Render the carousel div with visibility class and all drag event handlers

In App.tsx:
- Remove carouselRef, isDragging, startX, scrollLeft refs
- Remove drag handler functions
- Remove carousel scroll useEffect
- Import ChannelCarousel from './components/ChannelCarousel'
- Replace carousel JSX (lines 336-354) with `<ChannelCarousel channels={channels} selectedIndex={selectedIndex} onSelectChannel={playChannel} visible={contentVisible} />`

Do NOT change any class names, do NOT change any styling, do NOT add new features.
  </action>
  <verify>
    - `npm run build` succeeds without errors
    - `npm run lint` passes
    - File exists: src/components/ChannelCarousel.tsx
    - App.tsx no longer contains carousel refs or drag handlers
    - App.tsx uses ChannelCarousel component
  </verify>
  <done>
    - ChannelCarousel.tsx exists with proper TypeScript types
    - Drag functionality works (scroll, grab cursor)
    - Auto-scroll to selected channel works
    - App.tsx reduced by ~50 lines (refs, handlers, effect, JSX)
    - No regression in carousel behavior
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Extracted ChannelCard and ChannelCarousel components from App.tsx</what-built>
  <how-to-verify>
    1. Run: `npm run dev` in the Tuner directory
    2. Open: http://localhost:5173
    3. Verify carousel renders with all channel thumbnails
    4. Click a channel thumbnail - verify it selects and plays
    5. Use arrow keys (left/right) - verify carousel scrolls and channels change
    6. Click and drag the carousel - verify drag-to-scroll works
    7. Verify selected channel has white border and larger size
    8. Verify channel titles appear below thumbnails
  </how-to-verify>
  <resume-signal>Type "approved" if carousel works identically to before, or describe any issues</resume-signal>
</task>
</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] Both new component files exist in src/components/
- [ ] App.tsx imports and uses both components
- [ ] App.tsx is reduced in size (target: ~50-80 lines removed)
- [ ] No visual or functional changes to carousel behavior
</verification>

<success_criteria>
- ChannelCard.tsx and ChannelCarousel.tsx created in src/components/
- App.tsx reduced from ~452 lines to ~370-400 lines
- All carousel functionality preserved (display, selection, drag, keyboard nav)
- TypeScript compilation succeeds
- Human verification confirms no regression
</success_criteria>

<output>
After completion, create `.planning/phases/05-ui-refactoring/05-01-SUMMARY.md`:

```markdown
---
phase: 05-ui-refactoring
plan: 01
type: execute
status: complete
---

# Phase 5 Plan 1: Carousel Component Extraction

**[One-liner describing what was accomplished]**

## Accomplishments
- [ ] Created src/components/ directory structure
- [ ] Extracted ChannelCard.tsx component
- [ ] Extracted ChannelCarousel.tsx component
- [ ] Reduced App.tsx by ~XX lines

## Files Created
- src/components/ChannelCard.tsx
- src/components/ChannelCarousel.tsx

## Files Modified
- src/App.tsx (export Channel interface, use new components)

## Patterns Established
- Component extraction pattern for this project
- Props interface naming convention
- Relative imports from components/

## Next Plan Readiness
Ready for 05-02-PLAN.md (PlayerControls + StationPicker extraction)
```
</output>
